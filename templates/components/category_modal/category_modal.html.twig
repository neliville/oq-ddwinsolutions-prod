{# Live Component Modal pour ajouter/modifier une catégorie #}
<div {{attributes}}>
	<div class="modal fade {{ isOpen ? 'show' : '' }}" id="categoryModal" tabindex="-1" aria-labelledby="categoryModalTitle" aria-hidden="{{ isOpen ? 'false' : 'true' }}" style="{{ isOpen ? 'display: block;' : 'display: none;' }}" data-bs-backdrop="static" data-bs-keyboard="false" data-ishikawa-target="categoryModal">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="categoryModalTitle">
						{{ categoryId ? 'Modifier la catégorie' : 'Ajouter une catégorie' }}
					</h5>
					<button type="button" class="btn-close" data-action="click->ishikawa#closeCategoryModal" aria-label="Fermer"></button>
				</div>
				<div class="modal-body">
					<div class="mb-3">
						<label for="categorySelect" class="form-label">Catégorie prédéfinie :</label>
						<select class="form-select" id="categorySelect" {{ live('change') }} data-action="change->ishikawa#handleCategorySelectChange" data-ishikawa-target="categorySelect">
							<option value="">-- Sélectionner une catégorie --</option>
							{% for cat in availableCategories %}
								{% if cat not in usedCategories or (categoryId and categoryName == cat) %}
									<option value="{{ cat }}" {{ selectedCategory == cat ? 'selected' : '' }}>
										{{ cat }}
									</option>
								{% endif %}
							{% endfor %}
							<option value="custom" {{ isCustom ? 'selected' : '' }}>Catégorie personnalisée...</option>
						</select>
					</div>

					<div class="mb-3" id="customCategoryGroup" style="{{ isCustom ? 'display: block;' : 'display: none;' }}">
						<label for="categoryName" class="form-label">Nom personnalisé :</label>
						<input type="text" class="form-control" id="categoryName" placeholder="Nom de la catégorie" value="{{ categoryName }}" {{ live('change') }} data-action="input->ishikawa#handleCategoryNameChange" data-ishikawa-target="categoryName">
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-action="click->ishikawa#closeCategoryModal">Annuler</button>
					<button type="button" class="btn btn-primary" {{ live('save') }} data-action="click->ishikawa#saveCategoryModal">Enregistrer</button>
				</div>
			</div>
		</div>
	</div>
</div>
{% if isOpen %}
	<div class="modal-backdrop fade show"></div>
{% endif %}
