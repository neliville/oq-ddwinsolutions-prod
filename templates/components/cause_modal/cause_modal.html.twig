{# Live Component Modal pour ajouter/modifier une cause #}
<div {{attributes}}>

	<div class="modal fade {{ isOpen ? 'show' : '' }}" id="causeModal" tabindex="-1" aria-labelledby="causeModalTitle" aria-hidden="{{ isOpen ? 'false' : 'true' }}" style="{{ isOpen ? 'display: block;' : 'display: none;' }}" data-bs-backdrop="static" data-bs-keyboard="false" data-ishikawa-target="causeModal">
		<div class="modal-dialog modal-dialog-centered modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="causeModalTitle">
						{{ causeIndex !== null ? 'Modifier la cause' : 'Ajouter une cause' }}
					</h5>
					<button type="button" class="btn-close" data-action="click->ishikawa#closeCauseModal" aria-label="Fermer"></button>
				</div>
				<div
					class="modal-body">
					<!-- Sélecteur de type (texte ou image) -->
					<div class="mb-3">
						<label for="causeType" class="form-label">Type de cause :</label>
						<select class="form-select" id="causeType" {{ live('change') }} data-action="change->ishikawa#toggleCauseType" data-ishikawa-target="causeType">
							<option value="text" {{ causeType == 'text' ? 'selected' : '' }}>Texte</option>
							<option value="image" {{ causeType == 'image' ? 'selected' : '' }}>Image</option>
						</select>
					</div>

					<!-- Groupe pour le texte -->
					<div id="causeTextGroup" class="mb-3" style="{{ causeType == 'text' ? '' : 'display: none;' }}">
						<label for="causeName" class="form-label">Description de la cause :</label>
						<input type="text" class="form-control" id="causeName" placeholder="Décrivez la cause..." value="{{ causeText }}" {{ live('change') }} data-action="input->ishikawa#handleCauseTextChange" data-ishikawa-target="causeName">
					</div>

					<!-- Groupe pour l'image -->
					<div id="causeImageGroup" class="mb-3" style="{{ causeType == 'image' ? '' : 'display: none;' }}">
						<label for="causeImage" class="form-label">Image de la cause :</label>
						<input type="file" class="form-control" id="causeImage" accept="image/*" data-action="change->ishikawa#handleImageUpload" data-ishikawa-target="causeImage">
						<div class="mt-3">
							<label class="form-label">Aperçu :</label>
							<div class="border rounded p-2 text-center" style="min-height: 150px;">
								{% if causeImage %}
									<img id="causeImagePreview" src="{{ causeImage }}" alt="Aperçu de l'image" class="img-fluid" style="max-width: 100%; max-height: 300px; display: block;" data-ishikawa-target="causeImagePreview">
									<p class="text-muted mb-0" id="causeImagePlaceholder" style="display: none;">Aucune image sélectionnée</p>
								{% else %}
									<img id="causeImagePreview" src="" alt="Aperçu de l'image" class="img-fluid" style="max-width: 100%; max-height: 300px; display: none;" data-ishikawa-target="causeImagePreview">
									<p class="text-muted mb-0" id="causeImagePlaceholder">Aucune image sélectionnée</p>
								{% endif %}
							</div>
						</div>
						<div class="mt-2">
							<label for="causeImageText" class="form-label">Texte descriptif (optionnel) :</label>
							<input type="text" class="form-control" id="causeImageText" placeholder="Texte descriptif pour l'image..." value="{{ causeImageText }}" {{ live('change') }} data-action="input->ishikawa#handleCauseImageTextChange" data-ishikawa-target="causeName">
							<small class="form-text text-muted">Ce texte sera affiché comme alternative si l'image ne charge pas</small>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-action="click->ishikawa#closeCauseModal">Annuler</button>
					<button type="button" class="btn btn-primary" {{ live('save') }} data-action="click->ishikawa#saveCauseModal">Enregistrer</button>
				</div>
			</div>
		</div>
	</div>
</div>
{% if isOpen %}
	<div class="modal-backdrop fade show"></div>
{% endif %}
