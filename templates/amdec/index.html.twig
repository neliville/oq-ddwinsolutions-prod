{% extends (app.user ? 'base_with_sidebar.html.twig' : 'base.html.twig') %}

{% block title %}Analyse AMDEC en Ligne ‚Äî Calcul NPR et Priorisation Gratuit | Outils-Qualit√©{% endblock %}

{% block meta_description %}R√©alisez votre analyse AMDEC en ligne : identification des modes de d√©faillance, calcul automatique de l'indice NPR, recommandations de priorisation. Gratuit.{% endblock %}

{% block meta_keywords %}amdec, fmeca, analyse de risques, npr, criticit√©, modes de d√©faillance, outil qualit√©{% endblock %}

{% block og_title %}Analyse AMDEC - Outil Gratuit | OUTILS-QUALIT√â{% endblock %}

{% block og_description %}Identifiez les modes de d√©faillance, calculez l'indice NPR et priorisez vos actions gr√¢ce √† l'outil AMDEC en ligne.{% endblock %}

{% block schema_type %}{{ parent() }},SoftwareApplication{% endblock %}

{% block schema_data %}
{
    "name": "Outil AMDEC",
    "description": "Analyse FMECA compl√®te avec calcul d'indice NPR et recommandations.",
    "url": "{{ absolute_url(path('app_amdec_index')) }}",
    "screenshot": "{{ app.request.schemeAndHttpHost ~ asset('img/og-default.jpg') }}"
}
{% endblock %}

{% block schema_webapp_json %}
{"@context":"https://schema.org","@type":"WebApplication","name":"Analyse AMDEC en ligne","url":{{ absolute_url(path('app_amdec_index'))|json_encode|raw }},"applicationCategory":"BusinessApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"EUR"},"description":"R√©alisez votre analyse AMDEC en ligne : identification des modes de d√©faillance, calcul automatique de l'indice NPR, recommandations de priorisation. Gratuit.","featureList":["Modes de d√©faillance","Calcul NPR automatique","Priorisation des actions","Gratuit"]}
{% endblock %}

{% block schema_breadcrumb_json %}
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Accueil","item":{{ absolute_url(path('app_home_index'))|json_encode|raw }}},{"@type":"ListItem","position":2,"name":"Outils","item":{{ absolute_url(path('app_outils_index'))|json_encode|raw }}},{"@type":"ListItem","position":3,"name":"Analyse AMDEC","item":{{ absolute_url(path('app_amdec_index'))|json_encode|raw }}}]}
{% endblock %}

{% block content %}
<main class="amdec-page{% if not app.user %} amdec-page--guest{% endif %}">
    <div class="container">
        <input type="hidden" id="amdecAnalysisId" value="{{ analysisId ?? '' }}">

        <header class="amdec-header" data-aos="fade-up">
            <h1>Analyse AMDEC</h1>
            <p class="lead">Identifiez les modes de d√©faillance, mesurez leur criticit√© (NPR) et priorisez vos actions pour s√©curiser vos process.</p>
        </header>

        {% if not app.user %}
        <div class="alert alert-warning text-center mb-3" role="alert" aria-live="polite" data-aos="fade-up" data-aos-delay="40">
            <i data-lucide="info" width="18" height="18" class="me-2" aria-hidden="true"></i>
            <strong>Vous n'√™tes pas connect√©.</strong>
            <a href="{{ path('app_login') }}" class="alert-link">Connectez-vous</a> pour sauvegarder vos analyses et les √©diter ult√©rieurement.
        </div>
        {% endif %}

        <section class="amdec-guide-card" data-aos="fade-up" data-aos-delay="60">
            <div class="amdec-guide-card__title">üß† Guide express AMDEC</div>
            <p>La m√©thode AMDEC (Analyse des Modes de D√©faillance, de leurs Effets et de leur Criticit√©) vous aide √† anticiper les risques d'un produit ou d'un process. Renseignez pour chaque d√©faillance : la gravit√© (G), l'occurrence (O) et la d√©tection (D). Le produit de ces trois valeurs donne l'indice NPR.</p>
            <div class="amdec-guide-card__grid">
                <div class="amdec-guide-card__item">
                    <h3>‚ö†Ô∏è Gravit√© (G)</h3>
                    <p>Impact de la d√©faillance sur le client, le process ou la s√©curit√©. Plus la cons√©quence est grave, plus la valeur est √©lev√©e.</p>
                </div>
                <div class="amdec-guide-card__item">
                    <h3>üîÅ Occurrence (O)</h3>
                    <p>Fr√©quence de survenue de la d√©faillance. √âvaluez la probabilit√© que le probl√®me se produise.</p>
                </div>
                <div class="amdec-guide-card__item">
                    <h3>üîç D√©tection (D)</h3>
                    <p>Capacit√© √† d√©tecter la d√©faillance avant qu'elle n'affecte le client. Plus la d√©tection est difficile, plus la note est √©lev√©e.</p>
                </div>
            </div>
        </section>

        <section class="amdec-controls tool-actions-bar d-flex flex-wrap align-items-center gap-2 mb-3" data-aos="fade-up" data-aos-delay="80" role="toolbar" aria-label="Actions disponibles">
            <button class="btn btn-primary btn-sm" type="button" onclick="newAmdecAnalysis()" aria-label="Initialiser une nouvelle analyse AMDEC">
                <i class="fas fa-sync-alt me-2"></i>Nouvelle analyse
            </button>
            <button class="btn btn-info btn-sm" type="button" onclick="generateAmdecReport()" aria-label="Calculer l'analyse AMDEC">
                <i class="fas fa-chart-bar me-2"></i>G√©n√©rer l'analyse
            </button>
            <button class="btn btn-outline-danger btn-sm" type="button" onclick="resetAmdecForm()" aria-label="R√©initialiser le formulaire AMDEC">
                <i class="fas fa-eraser me-2"></i>R√©initialiser
            </button>
            {% if app.user %}
            <button class="btn btn-success btn-sm" type="button" onclick="saveAmdec()" aria-label="Sauvegarder l'analyse AMDEC">
                <i class="fas fa-save me-2"></i>Sauvegarder
            </button>
            <button class="btn btn-outline-secondary btn-sm" type="button" onclick="openAmdecSaved()" aria-label="Charger une analyse AMDEC">
                <i class="fas fa-folder-open me-2"></i>Mes analyses
            </button>
            <div class="dropdown export-dropdown" data-controller="dropdown-basic">
                <button class="btn btn-info btn-sm dropdown-toggle" type="button" id="amdecExportDropdown" data-dropdown-basic-target="button" data-action="click->dropdown-basic#toggle keydown.enter->dropdown-basic#toggle keydown.space->dropdown-basic#toggle keydown.arrow-down->dropdown-basic#openWithKeyboard keydown.arrow-up->dropdown-basic#openWithKeyboard" aria-haspopup="true" aria-expanded="false" aria-label="Options d'export">
                    <i class="fas fa-download me-2"></i>Exporter
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="amdecExportDropdown" data-dropdown-basic-target="menu" hidden>
                    <li><button class="dropdown-item" type="button" onclick="exportAmdec('png')">Exporter en PNG</button></li>
                    <li><button class="dropdown-item" type="button" onclick="exportAmdec('pdf')">Exporter en PDF</button></li>
                    <li><button class="dropdown-item" type="button" onclick="exportAmdec('json')">Exporter en JSON</button></li>
                </ul>
            </div>
            {% else %}
            {% include 'components/tool_actions_login.html.twig' %}
            {% endif %}
        </section>

        <section class="amdec-scale" data-aos="fade-up" data-aos-delay="120">
            <article class="amdec-scale__card">
                <h3>üìä Gravit√© (G)</h3>
                <table>
                    <tr><td>1</td><td>Mineure ‚Äì Aucun effet notable</td></tr>
                    <tr><td>2-3</td><td>Faible ‚Äì Impact limit√©, g√™nes mineures</td></tr>
                    <tr><td>4-6</td><td>Mod√©r√©e ‚Äì Insatisfaction client, retouche</td></tr>
                    <tr><td>7-8</td><td>√âlev√©e ‚Äì Perte de fonction, arr√™t de ligne</td></tr>
                    <tr><td>9-10</td><td>Critique ‚Äì Danger, non-conformit√© l√©gale</td></tr>
                </table>
            </article>
            <article class="amdec-scale__card">
                <h3>üîÑ Occurrence (O)</h3>
                <table>
                    <tr><td>1</td><td>Quasi impossible (‚â§ 1 / 10 000)</td></tr>
                    <tr><td>2-3</td><td>Rare (‚âà 1 / 1 000)</td></tr>
                    <tr><td>4-6</td><td>Occasionnelle (‚âà 1 / 100)</td></tr>
                    <tr><td>7-8</td><td>Fr√©quente (‚âà 1 / 10)</td></tr>
                    <tr><td>9-10</td><td>Tr√®s fr√©quente (&gt; 1 / 10)</td></tr>
                </table>
            </article>
            <article class="amdec-scale__card">
                <h3>üîç D√©tection (D)</h3>
                <table>
                    <tr><td>1</td><td>Quasi certaine ‚Äì D√©tection syst√©matique</td></tr>
                    <tr><td>2-3</td><td>√âlev√©e ‚Äì Presque toujours d√©tect√©e</td></tr>
                    <tr><td>4-6</td><td>Moyenne ‚Äì D√©tection partielle</td></tr>
                    <tr><td>7-8</td><td>Faible ‚Äì D√©tection difficile</td></tr>
                    <tr><td>9-10</td><td>Quasi impossible ‚Äì Aucune d√©tection</td></tr>
                </table>
            </article>
        </section>

        <section class="amdec-form" data-aos="fade-up" data-aos-delay="160" id="amdecForm">
            <h2>Saisie des modes de d√©faillance</h2>
            <div class="mb-4">
                <label class="form-label fw-semibold" for="amdecSubject">Processus / produit analys√©</label>
                <input type="text"
                       id="amdecSubject"
                       class="form-control"
                       placeholder="Ex : Ligne d'assemblage moteur"
                       oninput="updateAmdecSubject(this.value)">
            </div>
            <div class="amdec-entries" id="amdecEntries" aria-live="polite"></div>
            <button class="btn btn-outline-success btn-sm mt-3" type="button" onclick="addAmdecEntry()" aria-label="Ajouter un mode de d√©faillance">
                <i class="fas fa-plus me-2"></i>Ajouter un mode de d√©faillance
            </button>
        </section>

        <section id="amdecResults" class="amdec-results" style="display: none;" data-aos="fade-up" data-aos-delay="200">
            <div class="amdec-summary">
                <div class="amdec-summary__card">
                    <h4>Modes de d√©faillance analys√©s</h4>
                    <div class="value" id="amdecTotalCount">0</div>
                </div>
                <div class="amdec-summary__card">
                    <h4>Risques critiques (NPR &gt; 125)</h4>
                    <div class="value" id="amdecCriticalCount" style="color:#ef4444;">0</div>
                </div>
                <div class="amdec-summary__card">
                    <h4>NPR moyen</h4>
                    <div class="value" id="amdecAverageNpr">0</div>
                </div>
            </div>

            <div class="amdec-table">
                <table>
                    <thead>
                        <tr>
                            <th>Fonction / Processus</th>
                            <th>Mode de d√©faillance</th>
                            <th>Effet</th>
                            <th>Cause</th>
                            <th>G</th>
                            <th>O</th>
                            <th>D</th>
                            <th>NPR</th>
                            <th>Priorit√©</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="amdecTableBody"></tbody>
                </table>
            </div>

            <div class="amdec-insights" id="amdecInsights"></div>
        </section>

        {% include 'components/tool_lead_cta.html.twig' %}
        {% include 'components/cta_ddwin.html.twig' %}

        <section class="seo-content">
            <h2>Qu'est-ce que l'analyse AMDEC ?</h2>
            <p>Analyse des Modes de D√©faillance, de leurs Effets et de leur Criticit√© (FMEA en anglais). M√©thode pr√©ventive d'analyse des risques qui permet d'identifier les d√©faillances potentielles d'un produit, processus ou syst√®me, d'√©valuer leur criticit√© (indice NPR = Gravit√© √ó Occurrence √ó D√©tection) et de prioriser les actions correctives.</p>

            <h2>Comment utiliser l'analyse AMDEC ?</h2>
            <p>(1) Identifier les modes de d√©faillance. (2) √âvaluer la gravit√©, l'occurrence et la d√©tectabilit√© (√©chelles 1-10). (3) Calculer le NPR (Note de Priorit√© du Risque). (4) Prioriser les actions pour les NPR les plus √©lev√©s.</p>

            <h2>Quand utiliser l'analyse AMDEC ?</h2>
            <p>Conception de nouveau produit, optimisation de processus existant, plan de maintenance pr√©ventive, certification ISO 9001.</p>

            <h2>Pourquoi utiliser notre outil en ligne ?</h2>
            <p>Gratuit, sans installation, export PDF, conforme ISO, RGPD, sauvegarde.</p>
        </section>
    </div>
</main>
{% endblock %}

{% block stylesheets %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
<link rel="stylesheet" href="{{ asset('styles/tools/amdec.scss') }}" data-turbo-track="reload">
{% endblock %}

{% block javascripts %}
<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="{{ asset('js/main.js') }}"></script>
<script src="{{ asset('js/amdec.js') }}"></script>
<script>
    window.amdecAppConfig = {
        isAuthenticated: {{ app.user ? 'true' : 'false' }},
        analysisId: {{ analysisId is defined and analysisId ? analysisId : 'null' }},
        currentAnalysisId: null,
    };

    window.amdecRoutes = {
        save: '{{ path('app_api_amdec_save') }}',
        list: '{{ path('app_api_amdec_list') }}',
        get: '{{ path('app_api_amdec_get', {id: 0}) }}',
        delete: '{{ path('app_api_amdec_delete', {id: 0}) }}',
        login: '{{ path('app_login') }}'
    };
</script>
{% endblock %}


